# docker-invoicing
Invoice Ninja v5 in docker

## Application Setup
To not break whatever crazy stuff the designers did, we're going to use the original paths (mostly). We plan on deploying via portainer, we'll use stack.env as our environment file.

Our env file contains the environment we want (prod, test, demo, etc). This is expected as APPENVIRO and we use it in the folder path.

We also need to modify $INVOL/config/nginx/in-vhost.conf to make it match our container name 'invoiceninja-app' rather than just 'app'

AND setup backups (see backup-script.sh).


Let's make this easy
```bash
INVOL=/home/finchtech/appdata/invoice-ninja
git clone https://github.com/invoiceninja/dockerfiles.git $INVOL
chmod 755 $INVOL/docker/app/public
sudo chown -R 1500:1500 $INVOL/docker/app
/bin/sed -i "s/fastcgi_pass app:9000;/fastcgi_pass invoiceninja-app:9000;/" $INVOL/config/nginx/in-vhost.conf
mkdir -p $INVOL/docker/app/db/backups
```

Generate an `APP_KEY` for our stack.env file

```bash
docker run --rm -it invoiceninja/invoiceninja:5.6.5 php artisan key:generate --show
```

## Updating Invoice Ninja
Supposedly all we have to do is pull the latest image & restart the stack. We're using latest for nginx & mariaDB but pinned the version for InvoiceNinja, so update that as necessary.
```bash
docker pull invoiceninja/invoiceninja:5.6.5
```





## From the original docs
If `IN_USER_EMAIL` and `IN_PASSWORD` is not set the default user email and password is "admin@example.com" and "changeme!" respectively. You will use this for the initial login, thereafter, you can delete this two environment variables.

The `APP_KEY` can be generated by running

```bash
docker run --rm -it invoiceninja/invoiceninja php artisan key:generate --show
```

Copy the entire string and insert in the env file at `APP_KEY=base64....`

To ensure folder permissions are correct when the container comes up for the first time it is important that you set the correct folder permissions on the `docker` folder.

From the terminal run

```bash
chmod 755 docker/app/public
sudo chown -R 1500:1500 docker/app
```